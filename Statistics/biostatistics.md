# เอกสารประกอบการสอน
## รายวิชาการจัดการข้อมูลด้วยคอมพิวเตอร์ (MTID204)

## เรื่องชีวสถิติเบื้องต้น (Basic Biostatistics)

โดยอาจารย์ ดร.ลิขิต ปรียานนท์

ปรับปรุงวันที่ 5/5/63

---

## ค่าเฉลี่ยและการกระจายตัวของข้อมูล

ค่า **mean** หาได้จากสมการ

$\mu = \sum_{i=1}^{n} X_iP(X_i)$

ค่า **standard deviation** สามารถหาได้จากสมการ

$\sigma = \sqrt{\sum_{i=1}^{n}(X_i - \mu)^2P(X_i)}$


## Probability Distributions

การกระจายตัวของค่าความน่าจะเป็นแบ่งออกได้เป็นสองประเภทคือ

1. **Discrete probability distributions** (probability mass function)
สำหรับข้อมูลที่เป็นตัวเลขจำนวนเต็มเช่นการโยนเหรียญหัวก้อยจำนวนครั้งของเหตุการณ์
2. **Continous probability distributions** (probability density function)
สำหรับข้อมูลที่เป็นจำนวนจริงหรือทศนิยมเช่น ส่วนสูงและดัชนีมวลกายเป็นต้น

## Discrete Distribution

มีหลายประเภทเช่น

### Binomial Distribution

$P(X = x|n, p) = \frac{n!}{x!(n-x)!}p^x(1-p)^{n-x}$

ค่า **mean** และ **standard deviation** หาได้จากสมการ

$\mu = np$

$\sigma = \sqrt{np(1-p)}$

### Poisson Distribution

$P(X = x|\lambda) = \frac{e^{-\lambda}\lambda^x}{x!}$

ค่า population mean หาได้จาก

$\mu = \lambda$

ค่า standard deviation หาได้จาก

$\sigma = \sqrt{\lambda}$

---

### Continuous Distributions

หรือเรียกอย่างว่า probability density functions สำหรับข้อมูลที่เป็น continuous data เช่น ส่วนสูง น้ำหนักและอุณหภูมิเป็นต้น

ความน่าจะเป็นของ continuous distributions จะคำนวณเป็นช่วงของข้อมูลมากกว่าค่าใดค่าหนึ่ง ซึ่งความน่าจะเป็นหมายถึงโอกาสที่ค่าที่วัดได้จะอยู่ในช่วงใดช่วงหนึ่ง

ความน่าจะเป็นทั้งหมดคือ 1 หาได้จากค่าพื้นที่ใต้กราฟของ continuous distribution plot

continuous distribution มีหลายแบบและแต่ละแบบมีค่าพารามิเตอร์แตกต่างกัน continuous distribution ที่รู้จักกันมากที่สุดคือ normal distribution

### Normal Distribution

normal distribution หรือเรียกว่าการกระจายตัวแบบระฆังคว่ำ (bell curve) มีประโยชน์มากเนื่องจากสามารถโมเดลข้อมูลในธรรมชาติได้มากเช่น ส่วนสูง ความดันโลหิต ค่า IQ score เป็นต้น

สมการของการกระจายตัวแบบ normal distribution คือ

$f_{\mu,\sigma}(x)=\frac{1}{\sigma\sqrt{2\pi}}e^{-(x-\mu)^2/2\sigma^2}$

ดังนั้นรูปร่างของการกระจายตัวขึ้นกับพารามิเตอร์สองตัวคือ $\mu$ และ $\sigma$ ซึ่งคือค่า mean และ standard deviation ตามลำดับ

คุณลักษณะสำคัญของการกระจายตัวแบบ normal distribution

1. การกระจายตัวเป็นแบบสมมาตร
2. ค่า mean, median และ mode เท่ากัน
3. ครึ่งหนึ่งของข้อมูลมีค่าต่ำกว่าค่าเฉลี่ยและอีกครึ่งหนึ่งสูงกว่าค่าเฉลี่ย
4. สามารถคำนวณหาสัดส่วนของประชากรที่มีค่าต่างจากค่ากลางได้ด้วยสูตร 68-95-99.7 (empirical rule)

รูปที่ 1 แสดงการกระจายตัวแบบ normal distribution ของความน่าจะเป็นในการส่งพิซซ่าของบริษัทที่ 1

![normal distribution](pizza-norm.png)

จากรูปจะเห็นได้ว่าค่าเฉลี่ยของการส่งพิซซ่าคือ 30 นาทีและ 68% ของการส่งใช้เวลาในช่วงประมาณ 25-35 นาที ($\pm 1SD$) และ 95% ของการส่งทั้งหมดอยู่ใช้เวลาประมาณ 20-40 นาที ($\pm 2SD$)

รูปที่ 2 แสดงการกระจายตัวแบบ normal distribution ของความน่าจะเป็นในการส่งพิซซ่าของบริษัทที่ 2

![normal distribution](pizza-norm2.png)

จากรูปที่ 2 จะสังเกตได้ว่าการกระจายตัวแบบ normal distribution มีความแตกต่างจากรูปที่ 1 เนื่องจากค่า $mean$ และค่า $SD$ ที่แตกต่างกัน

### Standard Normal Distribution

standard normal distribution เป็น normal distribution ชนิดพิเศษเนื่องจากมีค่า $mean=0$ และค่า $SD=1.0$ standard normal distribution เรียกอีกอย่างหนึ่งว่า Z-distribution และค่าบน Z-distribution เรียกว่า Z-score หรือ standard score หมายถึงค่าที่อยู่เหนือหรือต่ำกว่าค่า mean เช่น Z-score 1.5 หมายความถึงค่านั้นมากกว่าค่าเฉลี่ย 1.5 standard deviation หากค่า standard score ติดลบ หมายถึงค่านั้นต่ำกว่าค่าเฉลี่ย ซึ่งค่าเฉลี่ยของ standard distribution มีค่าเท่ากับ 0 ดังแสดงในรูปที่ 3

รูปที่ 3 แสดงกราฟ standard normal distribution

![standard normal distribution](stdnorm.png)

เราสามารถคำนวณค่า standard score ได้จากสูตร

$Z=\frac{X-\mu}{\sigma}$

ความสำคัญของ normal distribution

1. การทดสอบทางสถิติหลายวิธีใช้สมมติฐานว่าข้อมูลมีการกระจายตัวแบบ normal distribution
2. สมการถดถอยใช้สมมติฐานว่าค่า residuals มีการกระจายตัวแบบ normal distribution
3. ทฤษฎี central limit theorem ระบุว่าเมื่อจำนวนตัวอย่าง (sample size) เพิ่มขึ้น ค่าการกระจายตัวของ sample mean เข้าใกล้ normal distribution

Excel มีฟังก์ชั่น ```NORM.DIST()``` สำหรับ normal distribution และ ```NORM.S.DIST()``` สำหรับ Z-distribution หรือ standard normal distribution

โดยมีค่าพารามิเตอร์คือ

```Excel
NORM.DIST(sample,mean,SD,cumulative)
```

สมมติว่าค่า HDL มีการกระจายตัวแบบ normal distribution โดยมีค่า $mean=54.3$ ค่า $SD=15$ เราสามารถหาค่าความน่าจะเป็นที่คนจะมีค่า HDL = 60 mg/dL ดังนี้

```Excel
NORM.DIST(60,54.3,15,0)
```
คำตอบคือความน่าจะเป็นเท่ากับ 0.024 หรือ 2.4% ที่คนจะมีค่า HDL=60 mg/dL 

หากเราต้องการหาความน่าจะเป็นที่คนมีโอกาสมีค่า HDL = 0-60 mg/dL สามารถคำนวณแบบ cumulative ดังนี้


```Excel
NORM.DIST(60,54.3,15,1)
```

คำตอบคือความน่าจะเป็นเท่ากับ 0.648 หรือ 64.8% ที่คนจะมีค่าตั้งแต่ 0-60 mg/dL

## Inferential Statistics

เนื่องจากเราไม่สามารถหาค่าทางสถิติแท้จริงของประชากร (population) เช่นค่าเฉลี่ยหรือค่า $SD$ ได้ เราจึงใช้ค่าทางสถิติของตัวอย่างในการประมาณซึ่งความแม่นยำของการประมาณขึ้นกับกระบวนการสุ่มเลือกตัวอย่างและจำนวนตัวอย่างที่มากพอ

การประมาณ (estimate) มีสองแบบคือ

1. point estimation เช่นการประมาณค่า mean ของประชากร การคาดคะเนค่าแบบนี้เกิดความผิดพลาดได้มาก
2. interval estimation การหาช่วงที่น่าจะครอบคลุมค่าจริงของประชากร

## Central Limit Theorem

central limit theorem คือปรากฏการณ์ที่เกิดเมื่อเราสุ่มเก็บตัวอย่างและหาค่าเฉลี่ยของกลุ่มตัวอย่างหลายๆ ครั้งและเมื่อนำค่าเฉลี่ยทั้งหมดมาสร้าง histogram จะมีการกระจายตัวใกล้เคียงกับ normal distribution ไม่ว่าการกระจายตัวของค่านั้นเดิมเป็นเช่นไร

รูปที่ 4 แสดงค่าการกระจายตัวของ sample mean เมื่อทำการสุ่มเก็บตัวอย่างจำนวน 20 คน 10 ครั้ง
![10s,20n](income-hist-11s.png)

รูปที่ 5 แสดงค่าการกระจายตัวของ sample mean เมื่อทำการสุ่มเก็บตัวอย่างจำนวน 20 คน 100 ครั้ง

![100s,20n](income-hist-101s.png)

รูปที่ 6 แสดงค่าการกระจายตัวของ sample mean เมื่อทำการสุ่มเก็บตัวอย่างจำนวน 20 คน 1000 ครั้ง

![1000s,20n](income-hist-1001s.png)

รูปที่ 7 แสดง histogram ของรายได้ของนักศึกษาทั้งหมด

![incom-hist](income-hist.png)

รูปที่ 8 แสดง histogram ของค่า sample mean จากข้อมูลที่มีขนาดตัวอย่าง 20 คน (เหลือง) และ 60 คน (ฟ้า) จากการสุ่มจำนวน 2000 ครั้ง

![hist-compare](income-hist-compare.png)

จากรูปที่ 8 จะพบว่าค่า $SD$ ของค่า sample mean ลดลงเมื่อจำนวนตัวอย่างเพิ่มมากขึ้น แสดงว่าค่า estimate ของค่า mean ของประชากรมีโอกาสที่จะถูกต้องมากยิ่งขึ้น ในทางกลับกันหากจำนวนตัวอย่างน้อย ค่า $SD$ ของข้อมูลจะกว้าง ความผิดพลาดก็จะมากขึ้น

### Standard Error

Standard error หมายถึงค่าที่บ่งบอกถึงการกระจายตัวของค่าทางสถิติเช่นค่า mean ของ population จาก sampling distribution ซึ่งสามารถคำนวณได้จากสูตรคือ

$SE = \frac{\sigma}{\sqrt{n}}$

โดย $\sigma$ คือ standard deviation ของประชากรและ $n$ คือขนาดของตัวอย่าง ดังนั้นเมื่อขนาดของตัวอย่างเพิ่มขึ้น ความคลาดเคลื่อนในการประมาณค่า mean จะลดลงซึ่งความสัมพันธ์นี้เรียกว่า _square-root of n rule_ ซึ่งการที่จะลดค่า $SE$ ลง 2 เท่าต้องเพิ่มขนาดของตัวอย่าง 4 เท่า

    ระวังอย่าสับสนระหว่าง Standard Deviation กับ Standard Error ค่า Standard Deviation บ่งบอกถึงการกระจายตัวของข้อมูลในตัวอย่างหรือจากประชากร แต่ Standard Error บ่งบอกความคลาดเคลื่อนของการประมาณค่าทางสถิติเช่นค่าเฉลี่ยของประชากรจากข้อมูลตัวอย่าง

## Hypothesis Testing

การทดสอบสมมติฐานทางสถิติมีแนวทางดังนี้

1. สร้างสมมติฐานที่สามารถพิสูจน์ได้
2. กำหนด _null hypothesis_
3. ตัดสินใจเลือกใช้การทดสอบทางสถิติ เก็บข้อมูลและคำนวณ
4. แปลและสรุปผล


สมมติว่าบริษัทยาแห่งหนึ่งต้องการทดสอบประสิทธิภาพของยาลดความดันโลหิตว่าดีกว่ายาที่ใช้ในปัจจุบันในผู้ป่วยที่มีคุณลักษณะคล้ายกัน เราสามารถตั้งสมมติฐานได้ว่าผู้ป่วยที่ได้รับการรักษาด้วยยาชนิดใหม่ (drug X) มีความดันโลหิตลดลงมากกว่าผู้ป่วยที่รักษาด้วยยาเดิม (drug Y) หากเรากำหนดให้ $\mu_{1}$ แทนค่าเฉลี่ยของความดันโลหิตที่ลดลงของผู้ป่วยที่ใช้ยา X และ $\mu_{2}$ แทนค่าความดันโลหิตที่ลดลงของผู้ป่วยที่ใช้ยา Y เราสามารถกำหนด null hypothesis ได้ดังนี้

$H_{0}: \mu_{1}\le\mu_{2}$

ดังนั้น alternative hypothesis ($H_{A}$ หรือ $H_{1}$) คือ

$H_{A}: \mu_{1}\gt\mu_{2}$


    null hypothesis และ alternative hypothesis ต้องเป็นแบบ mutually exclusive เท่านั้นคือไม่มีส่วนที่ซ้อนทับกัน เป็นได้อย่างได้อย่างหนึ่ง และผลลัพธ์ต้องเป็นแค่สองสมมติฐานนี้เท่านั้นไม่มีอย่างอื่น (exhaustive)

จากตัวอย่างนี้เราระบุว่าการจะปฏิเสธ (reject) null hypothesis นั้นค่า $\mu_{1}$ ต้องมากกว่าค่า $\mu_{2}$ เท่านั้น ซึ่งในกรณีนี้เราเรียก alternative hypothesis ว่าเป็นแบบ **_single-tailed_**

หากในอีกกรณีหนึ่งเราต้องการทดสอบแค่ว่าค่าการลดลงของความดันโลหิตในสองกลุ่มนั้นต่างกัน ไม่ว่ามากกว่าหรือน้อยกว่า เราจะตั้งสมมติฐานดังนี้


$H_{0}: \mu_{1}=\mu_{2}$

$H_{A}: \mu_{1}\ne\mu_{2}$

ซึ่งในกรณีนี้ alternative hypothesis จะเป็นแบบ **_two-tailed_** ซึ่งพบได้บ่อยในการทดสอบทางสถิติ

หลังจากการทดสอบจากการคำนวณจากข้อมูลที่รวบรวมได้แล้วเราสามารถตัดสินใจได้สองอย่างคือ

1. ปฏิเสธ null hypothesis
2. ไม่สามารถปฏิเสธ null hypothesis ได้

การที่เราไม่สามารถปฏิเสธ null hypothesis ได้นั้นไม่ใช่ว่า null hypothesis เป็นจริงหากแต่ว่าการศึกษาของเราไม่สามารถปฏิเสธได้เท่านั้น และโดยทั่วไปการที่เราปฏิเสธ null hypothesis นั้นก็ต่อเมื่อเราพบว่าความแตกต่างของค่าที่เราเปรียบเทียบนั้นมีนัยสำคัญทางสถิติหรือ **_statistically significant_** หรืออีกนัยหนึ่งคือผลที่ได้นั้นไม่ได้เกิดจากความบังเอิญ (randomness) ซึ่งก่อนการทดสอบทางสถิติเราควรจะกำหนดค่าระดับความน่าจะเป็นหรือ _p-value_ ที่ใช้เป็นตัวกำหนดการปฏิเสธ null hypothesis ซึ่งเรามักจะเห็นว่าเป็นค่า $p\lt0.05$ โดยทั่วไป ทั้งนี้เราอาจจะพบค่า p-value อื่นเช่น $p\lt0.01$ หรือ $p\lt0.001$ ได้เช่นกัน

การทดสอบทางสถิตินั้นเป็นหลักการที่อาศัยความน่าจะเป็นดังนั้นย่อมมีโอกาสที่จะผิดพลาด ซึ่งนักสถิติได้แบ่งออกเป็นสองแบบคือ

||||True state of population |
| --- | --- | --- | --- |
||| $H_{0}$ true | $H_{A}$ true |
|Decision based on sample statistics|Fail to reject $H_{0}$| Correct desicion: $H_{0}$ true and $H_{0}$ not rejected | Type II error or $\beta$
||Reject $H_{0}$|Type I error or $\alpha$|Correct decision:$H_{0}$ false and $H_{0}$ rejected|

การที่เรากำหนดค่า $\alpha=0.05$ หมายถึงเรายอมรับว่ามีความน่าจะเป็นร้อยละ 5% ที่จะเกิดความผิดพลาดเพราะเราปฏิเสธ $H_{0}$ ในขณะที่เราไม่สามารถจะปฏิเสธ $H_{0}$ ได้ (failed to reject $H_{0}$) 

#### ตัวอย่าง

สมมติเราต้องการทดสอบสมมติฐานว่าเหรียญที่มีสองด้านเป็นเหรียญที่มีมาตรฐานหรือไม่ หมายความว่าโอกาสที่จะโยนเหรียญแต่ละครั้งแล้วได้หัวหรือก้อยคือ 0.5 หากว่าเราทดลองโยนเหรียญ 10 ครั้งแล้วพบว่าได้หัว 8 ครั้งเหรียญนี้จะได้มาตรฐานหรือไม่

#### วิธีคิด

ปัญหาข้อนี้เราสามารถเปรียบเทียบความน่าจะเป็นของการได้หัว 8/10 ครั้งได้โดยการเปรียบเทียบจากความน่าจะเป็นของการกระจายตัวแบบ binomial distribution ซึ่งเมื่อเราคำนวณแล้วพบว่าโอกาสที่จะได้หัว 8/10 ครั้งคือ 0.0439 ทั้งนี้เนื่องจากเราต้องการทดสอบว่าเหรียญได้มาตรฐานหรือไม่ดังนั้นเราสามารถคำนวณหาโอกาสที่จะได้หัวอย่างน้อย 8 ครั้งคือ 8,9 และ 10 ได้เท่ากับ 0.0439 + 0.0098 + 0.0010 = 0.0547 โดย $P(h)=0.5$ ดังนั้นในกรณีนี้เราไม่สามารถสรุปได้ว่าเหรียญไม่ได้มาตรฐานเพราะความน่าจะเป็นหรือ $p-value\gt0.05$

## The Z-Statistic

สมการคือ

$Z = \frac{\overline{x}-\mu}{\frac{\sigma}{\sqrt{n}}}$

โดยสังเกตความแตกต่างระหว่าง z-score กับ z-statistic ว่าสำหรับ z-statistic ในสูตรตัวหารจะเป็น $\frac{\sigma}{\sqrt{n}}$ หรือคือ Standard Error (SE) นั่นเองแทนที่จะเป็น $\sigma$ เหมือนอย่างในสมการคำนวณหาค่า z-score นอกจากนั้นเราอาจจะมองว่า z-score ก็คือ z-statistic ที่มี $n=1$ นั่นเองเนื่องจาก $\sqrt{1}=1$

จากสมการหากต้องการคำนวณค่า Z-Statistic เราจำเป็นต้องทราบ standard deviation ของประชากรหรือ $\sigma$ หากไม่ทราบเราต้องใช้ t-statistic แทน

#### ตัวอย่าง

สมมติเราสุ่มตัวอย่างจากประชากรที่มีค่าเฉลี่ย 50 และ SD = 10 มาสามกลุ่มโดยทั้งสามกลุ่มมีค่า $\overline{x}=52$ และจำนวนตัวอย่างคือ 30, 60, 100 ตามลำดับ จงคำนวณค่า Z-statistic

#### วิธีคิด

$Z = \frac{52-50}{\frac{10}{\sqrt{30}}} = 1.10$

$Z = \frac{52-50}{\frac{10}{\sqrt{60}}} = 1.55$

$Z = \frac{52-50}{\frac{10}{\sqrt{100}}} = 2.00$

เห็นได้ว่าขนาดตัวอย่างที่เพิ่มมากขึ้นทำให้ค่า Z-Statistic เพิ่มมากขึ้นและเมื่อคำนวณค่า p-value พบว่ามีค่าดังนี้ตามลำดับ $p=0.2713$, $p=0.1211$, $p=0.0455$ หากเราตั้งค่า $\alpha=0.05$ เราจะพบว่ามีเพียงตัวอย่างกลุ่มที่สามเท่านั้นที่ค่าน้อยกว่าค่า $\alpha$ และเราสามารถปฏิเสธ $H_{0}$ ได้

### ตัวอย่าง

ครูใหญ่โรงเรียนแห่งหนึ่งได้รับผลการทดสอบ IQ จากนักเรียนคนหนึ่ง หากครูทราบว่าผลเฉลี่ย IQ ของนักเรียนในวัยเดียวกันทั้งประเทศคือ 100 และค่า SD คือ 15 ค่าทางสถิติใดที่จะช่วยแปลผลคะแนนของนักเรียนคนนี้หากการกระจายตัวของคะแนน IQ เป็นแบบ normal distribution

### วิธีคิด

เนื่องจากเราต้องการเปรียบเทียบคะแนนของนักเรียนกับคนอื่นในประเทศซึ่งถือว่าเป็นประชากร ค่า Z-score จึงเหมาะสม ดังนี้

$Z = \frac{80-100}{15} = -1.33$

ค่าติดลบหมายความว่าค่าคะแนนของนักเรียนคนนี้อยู่ต่ำกว่าค่าเฉลี่ยเท่ากับ 1.33 เท่าของ SD ซึ่งหากคำนวณจาก normal distribution พบว่าโอกาสที่จะได้คะแนนน้อยกว่าหรือเท่ากับ 1.33 เท่าของ SD คือ $P(Z\le-1.33)=1-P(Z\gt-1.33) = 1 - (0.50000 + 0.40824) = 0.09176$

    สูตรใน Excel คือ NORM.S.DIST(-1.33, TRUE) = 0.09176

หมายความว่าโอกาสที่จะมีนักเรียนที่ได้คะแนนน้อยกว่าหรือเท่ากับ 80 คือ 9%

#### ตัวอย่าง

นักเทคนิคการแพทย์ต้องการศึกษาผลของการทานอาหารมังสะวิรัตกับค่าคลอเลสเตอรอลในเลือด หากว่าค่าคลอเลสเตอรอลในผู้ชายระหว่างอายุ 20-65 ปี มีการกระจายตัวแบบ normal distribution ด้วยค่าเฉลี่ยเท่ากับ 210 mg/dL และค่า SD = 45 mg/dL หากนักเทคนิคการแพทย์ได้ทำการเก็บตัวอย่างจำนวน 40 คนที่อยู่ในกลุ่มอายุดังกล่าวหลังจากได้ทำการติดตามการทานอาหารมาเป็นเวลาหนึ่งปีและพบว่าค่าเฉลี่ยในกลุ่มนี้คือ 190 mg/dL ค่าสถิติใดที่ควรใช้ในการแปลผลนี้

#### วิธีคิด

เนื่องจากเราวิเคราะห์ค่าที่มาจากกลุ่มตัวอย่างเพื่อเปรียบเทียบกับประชากรในกลุ่มนี้ทั้งหมด ดังนั้นจึงควรใช้ Z-Statistic ซึ่งสามารถคำนวณได้ดังนี้

$Z = \frac{190-210}{\frac{45}{\sqrt{40}}} = -2.81$

ดังนั้นค่าเฉลี่ยของกลุ่มนี้ต่ำกว่าค่าเฉลี่ยของประชากรเท่ากับ 2.81 เท่าของ SD และค่าความน่าจะเป็นคือ

$P(Z\lt-2.81) = 1 - P(Z\ge-2.81) = 1 - (0.50000 + 0.49752) = 0.00248$

เนื่องจาก $P(Z\gt2.81) = 0.00248$ เพราะว่าการกระจายแบบ normal distribution มีรูปแบบสมมาตร ดังนั้นความน่าจะเป็นคือ

$P[(Z\le-2.81)\;OR \;P(Z\ge2.81)] = 2\times(0.00248)=0.00496$

    สูตรใน Excel คือ NORM.S.DIST(-2.81, TRUE) = 0.002478

หรือเราสามารถคำนวณค่าความน่าจะเป็นของค่า z-statistic ได้จาก

```Excel
NORM.DIST(190,210,7.115,TRUE) = 0.00247
```

โดย $\frac{\sigma}{\sqrt{n}}$ = $\frac{45}{\sqrt{40}} = 7.115$



เนื่องจากค่าความน่าจะเป็นที่จะได้ค่าเฉลี่ยเท่ากับ 190 mg/dL ในกลุ่มนี้น้อยกว่า 0.05 ดังนั้นเราจึงสามารถปฏิเสธ $H_{0}$ ได้ (การทานอาหารมังสวิรัตติดต่อกันไม่ทำให้เกิดความแตกต่างในระดับคอเลสเตอรอลในผู้ชายในกลุ่มอายุนี้)

### The $t$-Test

เมื่อเราไม่ทราบค่า standard deviation ของประชากรหรือ population และขนาดของตัวอย่าง (sample size) มีขนาดเล็ก เราไม่สามารถใช้คำนวณหาค่า z-statistic ได้ แต่เราสามารถคำนวณหาค่า t-statistic แทนได้ ค่า t-statistic มีการกระจายตัวคล้ายกับ normal distribution แต่ว่าด้านหางหรือ tail ของการกระจายตัวจะหนากว่า โดยลักษณะการกระจายตัวของ t-distribution จะขึ้นกับ degree of freedom ($df$) หากค่า degree of freedom มากลักษณะการกระจายตัวของ t-distribution จะใกล้เคียงกับ normal distribution

***รูปแสดงลักษณะของ t distribution***

![t-dist](t-distribution.jpg)

เราสามารถคำนวณหาค่า t-statistic ได้จากสมการ

$t = \frac{\overline{x}-\mu}{\frac{s}{\sqrt{n}}}$


โดย
* $\overline{x}$ คือค่าเฉลี่ยของตัวอย่าง
* $\mu$ คือค่าเฉลี่ยของ population
* $s$ คือค่า standard deviation
* $n$ คือขนาดตัวอย่าง

สังเกตว่าสมการนี้จะคล้ายกับการคำนวณหาค่า Z-statistic แต่ว่า t-statistic ใช้ SD ของตัวอย่างแต่ Z-statistic ใช้ SD ของประชากร ($\sigma$)


### One-Sample t-Test

หมายถึงการทดสอบค่าทางสถิติของตัวอย่างกับค่าสถิติของประชากรที่เราทราบเช่นค่าเฉลี่ย $H_{0}$ มักจะกำหนดให้ไม่มีความแตกต่างระหว่างค่าทางสถิติของกลุ่มตัวอย่างและกลุ่มประชากร

***ตัวอย่าง***

นักชีววิทยาตั้งสมมติฐานว่าอายุของเต่าทะเลในอ่าวเม็กซิโกลดลงหลังจากเกิดเหตุการณ์น้ำมันรั่วไหลลงทะเล สมมติว่านักวิทยาศาสตร์คาดเดาจากข้อมูลงานวิจัยอื่นๆ ว่าอายุของเต่าโดยเฉลี่ยอยู่ที่ 55 ปีและสงสัยว่าอายุของเต่าทะเลน่าจะลดลงประมาณ 10 ปีคือเหลือเท่ากับ 45 ปี นักวิทยาศาสตร์เก็บตัวอย่างเต่าทะเลมาได้ 16 ตัวและทำการประเมินอายุได้ค่าเฉลี่ยเท่ากับ 45 ปีและค่า SD=20 นักวิทยาศาสตร์จึงตั้ง null hypothesis ว่าอายุของเต่ามากกว่าหรือเท่ากับ 55 ปีและให้ alternative hypothesis ว่าอายุของเต่าน้อยกว่า 55 ปี

ในการวิจัยครั้งนี้นักวิทยาศาสตร์ยอมรับความผิดพลาดในการปฏิเสธ null hypothesis ได้ถึงร้อยละ 5 ($\alpha=0.05$) นักวิทยาศาสตร์จะสรุปผลการวิเคราะห์ว่าอย่างไร

***วิธีคิด***

เนื่องจากเราไม่ทราบค่าการกระจายตัวของประชากร ($\sigma$) และจำนวนตัวอย่างมีน้อย (16 ตัวอย่าง) ในการเปรียบเทียบค่า $\overline{X}$ กับ hypothetical mean (55 ปี) เราจึงไม่สามารถใช้ Z-test ได้ต้องใช้ $t$-test แทน

***แบบที่ 1***

เราสามารถหาค่า $critical\;value$ ได้จาก

```Excel
T.INV(0.05, 15)
```
โดยตัวเลขหลังคือ $degree\;of\;freedom = 16 - 1 = 15$

ค่า $critical\;value=-1.75$

เราสามารถคำนวณกลับเพื่อหาอายุได้ด้วยสูตร

$year = (-1.75\times 5) + 55 = 46.234$

หมายความว่าความน่าจะเป็นที่จะสุ่มได้ค่าเฉลี่ยของอายุที่น้อยกว่า 46.234 จากกลุ่มประชากรที่มีค่าอายุเฉลี่ย 55 ปีนั้นมีน้อยกว่า 0.05

***แบบที่ 2***

หรือเราสามารถหาค่า $t$-statistic

$t = \frac{45-55}{\frac{20}{\sqrt{16}}} = -2$

เมื่อคำนวณหาความน่าจะเป็นด้วยสูตรใน Excel จะได้

```Excel
0.031 = T.DIST(-2,15,1)
```
โดยตัวเลขกลางคือ $degree\;of\;freedom = 16 - 1 = 15$

ดังนั้นโอกาสที่จะได้ค่าเฉลี่ยของอายุเท่ากับ 45 ปีจากประชากรที่มีค่าเฉลี่ยของอายุ 55 ปี เท่ากับ 0.031 ซึ่งน้อยกว่าค่า $\alpha$ ดังนั้นนักวิทยาศาสตร์จึงมีเหตุผลมากพอที่จะปฏิเสธ null hypothesis โดยยอมรับความผิดพลาดได้ 5%

***ตัวอย่าง***

นักวิจัยสนใจศึกษาผลกระทบของการสัมผัสกับตะกั่วต่อสติปัญญาของเด็กอายุ 5 ปีในชุมชนแห่งหนึ่งในสหรัฐอเมริกาซึ่งมีค่าเฉลี่ยของระดับ IQ อยู่ที่ 100 และ SD=10 และมีการกระจายตัวแบบ normal distribution นักวิจัยสุ่มเลือกตัวอย่างมา 15 คนที่ได้เคยสัมผัสกับตะกั่วมาก่อนซึ่งค่าเฉลี่ยของ IQ ของกลุ่มนี้คือ 90 เด็กกลุ่มนี้มีระดับ IQ แตกต่างจากเด็กทั่วไปหรือไม่

***วิธีคิด***

เราสามารถคำนวณค่า t-statistic ได้จาก

$t = \frac{90-100}{\frac{10}{\sqrt{15}}} = -3.87$

$degree\;of\;freedom = 15 - 1 = 14$

ค่า upper critical value สำหรับ two-tailed $t$-test ที่มีค่า $df=14$ และ $\alpha=0.05$ คือ 2.1447 เนื่องจาก $|t| > 2.1447$ ดังนั้นเราจึงปฏิเสธ $H_{0}$ ได้และค่า $t$ ที่ติดลบแสดงว่าค่า IQ ของกลุ่มตัวอย่างมีค่าต่ำกว่าค่าเฉลี่ย

    Two-tailed t-statistic สามารถคำนวณได้จากสูตร T.INV.2T(0.05,14) = 2.1447

***ตัวอย่าง***

กุมารแพทย์ต้องการศึกษาว่าน้ำหนักตัวของทารกที่เสียชีวิตด้วยโรค SIDS มีความแตกต่างจากทารกทั่วไปหรือไม่หากค่าเฉลี่ยของน้ำหนักทารกในเขตนี้คือ 3300 กรัมและตัวอย่างทารกที่เสียชีวิตด้วย SIDS 10 คนมีค่าเฉลี่ยของน้ำหนักเท่ากับ 2890 กรัมและ SD=720 กรัม

***วิธีคิด***

เริ่มจากการตั้งสมมติฐาน

$H_{0}: \mu = 3300g$

$H_{A}: \mu \ne 3300g$

หาค่า $t$-statistic

$SE_{\overline{x}} = \frac{s}{\sqrt{n}} = \frac{720}{\sqrt{10}} = 227.7$

$t_{stat} = \frac{\overline{x}-\mu}{SE_{\overline{x}}} = \frac{2890-3300}{227.7} = -1.80$

คำนวณค่า $critical\;value$ ด้วย $\alpha=0.05$ ของ two-sided test ด้วย Excel

```Excel
2.26 = T.INV.2T(0.05, 9)
```

เนื่องจาก $|t|<2.26$ ดังนั้นแพทย์จึงไม่สามารถปฏิเสธ $H_{0}$ ได้

## Confidence Interval

เนื่องจากการประมาณค่าทางสถิติเช่นค่า mean จากการสุ่มตัวอย่างนั้นมีความผิดพลาดได้มาก จึงมักจะรายงานค่าเป็นช่วงที่เรียกว่า confidence interval (CI) โดยมีร้อยละนำหน้าเช่น ค่าเฉลี่ยของระดับ HDL ในเลือดนักศึกษามหาวิทยาลัยแห่งหนึ่งจากตัวอย่าง 40 คน มีค่าเฉลี่ย 47.2 ค่า 95% confidence interval คือ (43.24, 51.17) เป็นต้น โดยค่าตัวแรกในวงเล็บคือค่าขอบล่างและค่าที่สองคือขอบบนตามลำดับ
ค่าร้อยละนั้นเรียกว่า _level of confidence_ ซึ่งยิ่งค่าสูงมากค่า confidence interval จะยิ่งกว้าง

การแปลค่า CI ให้ถูกต้องนั้นต้องเริ่มจากการเข้าใจที่มาของค่านี้ก่อน สมมติว่าเราทำการสุ่มนักศึกษาจำนวน 40 คนเพื่อทำการประมาณค่า mean ของค่า HDL ในเลือดจากหลัก central limit theorem เราทราบว่าหากทำการสุ่มหลายๆ ตัวอย่างและนำมาหาค่า mean เพื่อนำมาสร้างกราฟ sampling distribution เราจะได้กราฟแบบ normal distribution ดังรูปที่ 10

**รูปที่ 10** แสดงกราฟ sampling distribution ของค่า HDL levels

![hdl-sampling-distribution](hdl1000samplingdist.png)

จะเห็นได้ว่าค่า mean น่าจะอยู่ที่ 50 mg/dL ซึ่งจากกฏของ normal distribution ทำให้เราทราบว่า 95% ของข้อมูลจะอยู่ในช่วง $\plusmn 2SD$ ซึ่งค่า SD ของ sampling distribution เราไม่ทราบหากทำการสุ่มเพียงครั้งเดียว แต่สามารถประมาณได้ด้วย Standard Error ดังที่กล่าวมาก่อนหน้านี้

$SE = \frac{\sigma}{\sqrt{n}}$

ดังนั้นถ้าเราทราบ SD ของตัวอย่าง เราสามารถคำนวณได้ว่าช่วงที่ร้อยละ 95 ของค่า mean ที่ได้จากการสุ่มจะอยู่ที่เท่าใด

**ตัวอย่าง**

สมมติเราทราบว่าค่าเฉลี่ยของประชากรคือ 50 mg/dL หากเราได้ค่า mean จากการสุ่มจำนวน 40 คนเท่ากับ 51.22 และค่า SD ของตัวอย่างคือ 15 เท่ากับ SD ของประชากร ($\sigma$) เราสามารถคำนวณค่า SE ได้ดังนี้

$SE = \frac{15}{\sqrt{40}} = 2.37$

ทั้งนี้เราทราบว่าค่า 95% ของข้อมูลอยู่คือค่าระหว่าง -1.96 กับ 1.96 SD ($\alpha=0.05, \frac{\alpha}{2}=0.025, 1 - \frac{\alpha}{2}=0.975$) ดังนั้นเราสามารถคำนวณค่าขอบล่างและขอบบนได้จาก

ขอบล่าง = $(-1.96\times SE) + 51.22 = 46.57$

ขอบบน = $(1.96\times SE) + 51.22 = 55.86$

    หากเราทราบค่าความน่าจะเป็นเราสามารถคำนวณหาค่า z score ได้จากสูตร NORM.INV(p,mean,std) เช่น NORM.INV(0.025,0,1)=-1.96 และ NORM.INV(0.975,0,1)=1.96 โดยกำหนดให้ค่า mean=0, SD=1 เราใช้ความน่าจะเป็นเท่ากับ 0.025 และ 0.975 เนื่องจากเราต้องการหาความน่าจะเป็น 0.95 ตรงกลางดังนั้นขอบสองข้างของกราฟ normal distribution ต้องเหลือพื้นที่ข้างละ 0.025 ดังรูปที่ 11

    ทั้งนี้เราสามารถใช้สูตร NORM.S.INV ได้เช่นเดียวกันโดยไม่ต้องระบุค่า mean และ SD เช่น NORM.S.INV(0.025) = -1.96

**รูปที่ 11** แสดงพื้นที่ 95% ของกราฟแบบ normal distribution ที่มีค่า mean=50, SD=15

![normal-dist-95%](normaldist-95.png)


ซึ่งหากค่า mean และ SE ใกล้เคียงความจริงเราจะพบว่าค่า mean ของประชากรจะอยู่ใน 95% CI = 46.31-56.12 รูปที่ 12 แสดงค่า mean จากการสุ่มหนึ่งครั้งและช่วง 95% CI ที่คำนวณได้

**รูปที่ 12** แสดงกราฟ sampling distribution ของค่า mean ที่มาจากการสุ่มหนึ่งครั้งและค่า 95% CI

![hdl-sampling-distribution-1mean](hdl1000samplingdist-1mean.png)

หากแต่ว่าเราสร้าง 95% CI มาจากการสุ่มเพียงหนึ่งครั้งเท่านั้น ซึ่งแต่ละครั้งที่เราสุ่ม เราก็สามารถหา 95% CI ได้หมายความว่าค่า 95% CI จะมีได้มากกว่า 1 ค่าดังรูปที่ 13

**รูปที่ 13** แสดงค่า 95% CI ที่มาจากการสุ่มแต่ละครั้งจำนวน 100 ตัวอย่างการสุ่ม

![hdl-sampling-distribution-100mean-100ci](hdl1000samplingdist-100mean-100ci.png)

จากรูปที่ 13 จะพบว่าค่า 95% CI บางค่าไม่รวมค่า mean ของประชากรซึ่งคือ 50 อยู่ในช่วงนั้นด้วย ดังแสดงในรูป 14

**รูปที่ 14** แสดงค่า 95% CI ที่ไม่รวมค่า mean ของประชากรจำนวน 8 ช่วง

![hdl-sampling-distribution-100mean-ci-out](hdl1000samplingdist-100mean-ci-out.png)

ซึ่งค่า 95% CI ที่ไม่รวมค่า mean ของประชากรนี้มาจากค่า mean ของการสุ่มที่อยู่นอก $2SD$ โดยประมาณหรืออยู่นอก 95% ของข้อมูลที่อยู่รอบค่า mean ของประชากร

**สรุป**

ค่า 95% CI คือค่าที่คำนวณจากข้อมูลที่ได้จากการสุ่มตัวอย่างโดยที่ร้อยละ 95 (โดยเฉลี่ย) ของช่วงที่ได้จากการสุ่มนั้นจะรวมค่าทางสถิติเช่นค่า mean ของประชากรอยู่ด้วย ทั้งนี้เราคาดว่าชุดข้อมูลที่เราสุ่มมานั้นจะอยู่ในร้อยละ 95 นั้นด้วย

**ตัวอย่าง**

จงคำนวณหา 99% CI จากข้อมูลข้างต้น

**วิธีคิด**

เราสามารถหาค่า Standard Error ได้จาก

$SE = \frac{15.83}{\sqrt{40}} = 2.50$

เราทราบว่าข้อมูลร้อยละ 99% อยู่ระหว่าง 0.5% - 99.5% หรือ 0.005 - 0.995 ($\alpha=0.01, \frac{\alpha}{2}=0.005, 1 - \frac{\alpha}{2} = 0.995$) ซึ่งเท่ากับ $z$ score ระหว่าง -2.57 - 2.17 ดังนั้นค่าขอบล่างและขอบบนของ 99% CI คือ

ขอบล่าง = $(-2.57\times 2.37) + 51.22 = 45.12$

ขอบบน = $(2.57\times 2.37) + 51.22 = 57.31$

    หากเราทราบค่าความน่าจะเป็นเราสามารถคำนวณหาค่า z score ได้จากสูตร NORM.INV(p,mean,std) เช่น NORM.INV(0.005,0,1) โดยกำหนดให้ค่า mean=0, SD=1

สังเกตว่าค่า

95% CI = (46.57, 55.86)

99% CI = (45.12, 57.31)

ดังนั้นเมื่อระดับความมั่นใจเพิ่มจาก 95% เป็น 99% เราสามารถมั่นใจได้ว่าข้อมูลค่า mean ของประชากรต้องอยู่ในระหว่าง 45.12 - 57.31 โดยข้อมูลของเราน่าจะอยู่ในร้อยละ 99 ของข้อมูลทั้งหมดที่ทำให้ CI ที่คำนวณได้ยังรวมค่า mean ของประชากรอยู่ ซึ่งสังเกตได้ว่าค่า 99% CI นั้นกว้างกว่า 95% CI ซึ่งหากลดระดับความมั่นใจลง ช่วงจะแคบลงเรื่อยๆ

    Excel มีสูตร CONFIDENCE.NORM และ CONFIDENCE.T สำหรับการคำนวณความกว้างของ confidence interval เราใช้ CONFIDENCE.NORM เมื่อเราทราบ SD ของประชากร และ CONFIDENCE.T เมื่อเราไม่ทราบ SD ของประชากร    


***ตัวอย่าง***

กุมารแพทย์ต้องการศึกษาว่าน้ำหนักตัวของทารกที่เสียชีวิตด้วยโรค SIDS ตัวอย่างทารก 10 คนมีค่าเฉลี่ยของน้ำหนักเท่ากับ 2890 กรัมและ SD=720 กรัม จงรายงานค่า 90% และ 95% confidence interval ของค่าเฉลี่ยน้ำหนัก

***วิธีคิด***

เนื่องจากเราไม่ทราบค่า SD ของประชากรทราบแต่ค่า SD ของตัวอย่างและจำนวนตัวอย่างน้อย จึงไม่สามารถใช้การกระจายตัวแบบ normal distribution ได้ เราจึงใช้การกระจายตัวแบบ t distribution แทน

เริ่มจากคำนวณ SE ของค่า mean

$SE_{\overline{x}} = \frac{720}{\sqrt{10}} = 227.7$

คำนวณหา 90% CI โดยกำหนด $\alpha=0.1$


ค่า $t_{stat}$ ที่ความน่าจะเป็น $\frac{\alpha}{2}=0.05$

```Excel
-1.83 = T.INV(0.05,9)
```

ค่า $t_{stat}$ ที่ความน่าจะเป็น $1 - \frac{\alpha}{2}=0.95$

```Excel
1.83 = T.INV(0.95,9)
```

ขอบล่าง = $(-1.83\times 227.7) + 2890 = 2472.6$
ขอบบน = $(1.83\times 227.7) + 2890 = 3307.4$

ดังนั้นค่า 90% CI ของค่าเฉลี่ยคือ (2472.6 ถึง 3307.4)

คำนวณหา 95% CI โดย ให้ $\alpha=0.05$


ค่า $t_{stat}$ ที่ความน่าจะเป็น $\frac{\alpha}{2}=0.025$

```Excel
-2.26 = T.INV(0.025,9)
```

ค่า $t_{stat}$ ที่ความน่าจะเป็น $1 - \frac{\alpha}{2} = 0.975$

```Excel
2.26 = T.INV(0.95,9)
```

ขอบล่าง = $(-2.26\times 227.7) + 2890 = 2374.9$
ขอบบน = $(2.26\times 227.7) + 2890 = 3405.1$

ดังนั้นค่า 95% CI ของค่าเฉลี่ยคือ (2374.9 ถึง 3405.1)

จะเห็นได้ว่าค่า 90% CI แคบกว่าช่วงของ 95% CI ทั้งนี้ค่าเฉลี่ยจริงของทารกในเขตนี้คือ 3300 กรัมซึ่งอยู่ในช่วงทั้งสองช่วง